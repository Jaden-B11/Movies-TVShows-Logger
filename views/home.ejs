<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>home</title>
    <link rel="stylesheet" href="/css/style.css">
    
</head>
<body>

    <%- include("partials/nav.ejs") %>

    <h1>Welcome, <%= Name %> </h1>

    <% for (let status in grouped) { %>
        <section>
          <h2 class="statusTitle <%= status %>">
            <% if (status == 'planned') { %>
                <%= status.charAt(0).toUpperCase() + status.slice(1, 5) %>ing to Watch
            <% } else { %>
                <%= status.charAt(0).toUpperCase() + status.slice(1) %>
            <% } %>

        </h2> 
      
          <% if (grouped[status].movies.length === 0 && grouped[status].shows.length === 0) { %>
            <p id="NoMedia">No media in this category.</p>
          <% } %>
      
          <div class="media-grid">
            <% for (let movie of grouped[status].movies) { %>
              <div class="media-card">
                <img src="<%= movie.movieImage %>" alt="Movie Image">
                <p><b><%= movie.movieName %></b></p> <p class="comments"><%= movie.comments %></p>

                <button class="media-button openEditModal"
                    data-id="<%= movie.movieId %>"
                    data-type="movie"
                    data-name="<%= movie.movieName %>"
                    data-status="<%= movie.movieStatus %>"
                    data-comments="<%= movie.comments %>">
                    Edit
                </button>
              </div>
            <% } %>
      
            <% for (let show of grouped[status].shows) { %>
              <div class="media-card">
                <img src="<%= show.showImage %>" alt="Show Image">
                <p><b><%= show.showName %></b></p> <p> <p class="comments"><%= show.comments %> </p>
                <button class="media-button openEditModal"
                    data-id="<%= show.showId %>"
                    data-type="show"
                    data-name="<%= show.showName %>"
                    data-status="<%= show.showStatus %>"
                    data-comments="<%= show.comments %>">
                    Edit
                </button>
              </div>
            <% } %>
          </div>
        </section>
      <% } %>
      
      <div id="editMediaModal" class="custom-modal hidden">
        <div class="custom-modal-content" style="box-shadow: 0 0 20px rgba(255, 227, 69, 0.463)">
          <span class="custom-close-button" id="closeEditModal">&times;</span>
          <h3 id="EditMedia">Edit Media</h3>
          <form method="POST" action="/editMedia" id="editMediaForm">
            <input type="hidden" name="mediaId" id="editMediaId">
            <input type="hidden" name="mediaType" id="editMediaType">
      
            <label>Status:</label><br>
            <select name="status" id="editStatus" required>
              <option value="">Select Status</option>
              <option value="Watching">Watching</option>
              <option value="Planned to Watch">Planned to Watch</option>
              <option value="Completed">Completed</option>
              <option value="Dropped">Dropped</option>
            </select>
      
            <br><br>
      
            <label>Comment:</label><br>
            <textarea name="comments" id="editComments" rows="3"></textarea>
      
            <br><br>
            <button type="submit" style="background-color: rgb(161, 188, 44);" class="media-button">Save Changes</button>
          </form>
        </div>
      </div>
      

      <script src="/js/script.js"></script>
</body>
</html>